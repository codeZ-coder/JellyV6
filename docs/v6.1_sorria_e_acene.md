# ğŸª¼ Jelly V6.1 "Sorria e Acene"
> *Release: 2026-02-16 | Codinome: Modo Chucro*

## Filosofia

A V6.1 implementa a defesa **Judo**: usar a forÃ§a do atacante contra ele mesmo.
O servidor NUNCA morre por ataque comum. Ele sorri, acena, e o atacante desaparece.

```
"Sorria e Acene" = Finja normalidade â†’ Marque o IP â†’ Silencie pra sempre
```

---

## Arquitetura de Defesa (6 Camadas)

```
         PressÃ£o (atm)
            â”‚
   1000+ â”€â”€ â˜ ï¸  RUPTURA â”€â”€â”€â”€â”€â”€â”€â”€ Auto-kill (Turritopsis). SÃ³ extremo.
            â”‚
    400+ â”€â”€ âš« BLACKHOLE â”€â”€â”€â”€â”€â”€â”€ IP banido. 204 vazio. SilÃªncio total.
            â”‚
    200+ â”€â”€ ğŸ”´ TARPIT/NEMATOCYST  Leitura lenta (5s) / Toxina
            â”‚
    100+ â”€â”€ ğŸŸ  CONTRACT â”€â”€â”€â”€â”€â”€â”€â”€ Delay 2s
            â”‚
     50+ â”€â”€ ğŸŸ¡ ACTIVE_PROBE â”€â”€â”€â”€ Micro-latÃªncia (fingerprint)
            â”‚
      0  â”€â”€ ğŸŸ¢ ALLOW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Acesso normal
```

### Fluxo do Honeypot (Sorria e Acene)
```
Atacante â†’ GET /admin
       â†“
Jelly â†’ 200 OK {"status": "success"}     â† ğŸ˜Š Sorria
       â†“
Marca IP com 500 atm (radioativo)
       â†“
Atacante â†’ qualquer request
       â†“
Jelly â†’ 204 No Content (vazio)            â† ğŸ‘‹ Acene
       â†“
IP na blackhole_list (permanente)
       â†“
Servidor â†’ vivo, atendendo Dashboard normalmente
```

---

## Componentes Modificados

### `core/membrane.py` â€” Membrana OsmÃ³tica
- **`blackhole_list: set`** â€” Conjunto de IPs permanentemente banidos
- **Threshold BLACKHOLE:** `pressure > threshold * 4` (400 atm)
- **Threshold RUPTURA:** `pressure > threshold * 10` (1000 atm) â€” era 4x
- **Honeypot pressure:** `threshold * 5` (500 atm) â€” era 10x (causava RUPTURA)

### `core/nervenet.py` â€” Sistema Nervoso
- **BLACKHOLE handler:** Retorna `Response(status_code=204)` limpo
- **Forense:** Cada BLACKHOLE registra no SQLite via `registrar_forense_async()`
- **`POST /ruptura`:** Endpoint de pÃ¢nico manual (SIGTERM)

### `interface/app.py` â€” Dashboard
- **BotÃ£o de PÃ¢nico (sidebar):** ğŸ”´ RUPTURA MANUAL com confirmaÃ§Ã£o em 2 passos
- **HUD limpo:** Removida barra tÃ©cnica (DNA/Stress/RAM)

---

## Bugs Corrigidos

| Bug | Arquivo | Fix |
|-----|---------|-----|
| `NameError: url` | `nervenet.py` | `url` â†’ `url_path` |
| `NameError: reflexo_ativo` | `cnidocyte.py` | Definir antes do return |
| `IndentationError` Judo | `nervenet.py` | Corrigir indentaÃ§Ã£o |
| `h11 Content-Length` | `nervenet.py` | `JSONResponse(204)` â†’ `Response(204)` |
| Honeypot = RUPTURA | `membrane.py` | PressÃ£o 10x â†’ 5x |
| Assertiva Dwell Time | `test_full_system.py` | 15 â†’ 14 (decrement) |

---

## ValidaÃ§Ã£o

### Testes UnitÃ¡rios (5/5 âœ…)
```bash
pytest tests/test_full_system.py -v
# test_trace_id_header         PASSED
# test_judo_honeypot           PASSED
# test_statocyst_spike_detection PASSED
# test_h_system_dwell_time     PASSED
# test_full_integration_flow   PASSED
```

### SimulaÃ§Ã£o "Sorria e Acene"
```bash
python tests/test_sorria_e_acene.py
```
Resultado:
```
ğŸš« RejeiÃ§Ãµes (401):     3
ğŸ˜Š Fake 200 (Honeypot): 1
ğŸ•³ï¸ Blackholes (204):    15
ğŸ’€ Servidor morreu:     NÃƒO âœ…
ğŸ† RESULTADO: SORRIA E ACENE FUNCIONOU!
```

### Predator V2 (Modo BOT)
```
[1/20] Status: 204 | Time: 0.01s
[2/20] Status: 204 | Time: 0.01s
...
[20/20] Status: 204 | Time: 0.00s
â†’ Servidor VIVO apÃ³s 20 requests de bot
```

### Forense no SQLite
```sql
SELECT * FROM forensic_events WHERE trigger_type = 'BLACKHOLE';
-- Retorna: timestamp, IP, pressÃ£o, snapshot TCP completo
```

---

## Controle Manual

### BotÃ£o de PÃ¢nico
1. Abra o Dashboard Streamlit
2. Clique no menu lateral (â˜°)
3. Clique em **ğŸ”´ RUPTURA MANUAL**
4. Confirme â†’ servidor derruba e Docker reinicia

### Query Forense
```bash
sqlite3 jelly.db ".mode column" ".headers on" \
  "SELECT timestamp, trigger_type, details FROM forensic_events ORDER BY timestamp DESC LIMIT 10;"
```

---

## PrÃ³ximos Levels (V6.2+)
- **Ecdise Real** â€” Troca dinÃ¢mica de portas sob ataque
- **VersÃ£o Mobile** â€” Physalia (Termux) para monitoramento remoto
- **eBPF** â€” VisÃ£o profunda do Kernel para detecÃ§Ã£o avanÃ§ada
- **Blackhole Decay** â€” TTL para IPs banidos (auto-perdÃ£o apÃ³s X horas)

---

*"A Ã¡gua-viva nÃ£o precisa de armadura. Ela Ã© transparente, mole, e letal."* ğŸª¼
